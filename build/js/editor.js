var SiteForgeEditor=function(e,t,l,o,r,n,i,s,a){"use strict";const c=e=>{if(void 0===window.siteforgeBlocks)return null;const t=window.siteforgeBlocks[e];if(!(null==t?void 0:t.fields))return null;const l=t.fields;return Array.isArray(l)&&0!==l.length?l:null},d=e=>void 0===window.siteforgeBlocks?null:window.siteforgeBlocks[e]||null,p={add:(e,t)=>[...e||[],t],remove:(e,t)=>(e||[]).filter((e,l)=>l!==t),move:(e,t,l)=>{const o=[...e||[]],[r]=o.splice(t,1);return o.splice(l,0,r),o},update:(e,t,l)=>{const o=[...e||[]];return o[t]=l,o},updateProp:(e,t,l,o)=>{const r=[...e||[]];return r[t]={...r[t],[l]:o},r}},u={isEmpty:e=>!e||(!(!Array.isArray(e)||0!==e.length)||"object"==typeof e&&0===Object.keys(e).length),getUrl:e=>u.isEmpty(e)?"":"string"==typeof e?e:"object"==typeof e&&(null==e?void 0:e.url)?e.url:"",getId:e=>u.isEmpty(e)?null:"number"==typeof e?e:"object"==typeof e&&(null==e?void 0:e.id)?e.id:null,formatValue:(e,t="url")=>{if(!e)return"";switch(t){case"id":return e.id;case"url":default:return e.url;case"object":return{id:e.id,url:e.url,alt:e.alt||"",title:e.title||"",width:e.width,height:e.height}}}},g={setProp:(e,t,l)=>({...e||{},[t]:l}),getProp:(e,t,l="")=>(null==e?void 0:e[t])??l,merge:(...e)=>Object.assign({},...e)},f=(e,t)=>({name:e,type:t.type||"text",label:t.label||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),config:t}),h=e=>{const t={};return e&&Object.entries(e).forEach(([e,l])=>{void 0!==l.default&&(t[e]=l.default)}),t},m={classNames:(...e)=>e.flat().filter(e=>"string"==typeof e?e:"object"==typeof e&&null!==e?Object.entries(e).filter(([,e])=>e).map(([e])=>e).join(" "):"").join(" ").trim(),inlineStyle:e=>{const t={};return Object.entries(e||{}).forEach(([e,l])=>{null!=l&&""!==l&&(t[e]=l)}),t}},x={isEmpty:e=>null==e||("string"==typeof e?""===e.trim():Array.isArray(e)?0===e.length:"object"==typeof e&&0===Object.keys(e).length),isValidUrl:e=>{try{return new URL(e),!0}catch{return!1}},isValidEmail:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},v=(e,t)=>l=>{e({[t]:l})},b=(e,t)=>{const l={};return t.forEach(t=>{l[t]=v(e,t)}),l},y={getBlockFields:c,getBlockData:d,arrayHelpers:p,imageHelpers:u,objectHelpers:g,styleHelpers:m,validationHelpers:x,normalizeField:f,createRepeaterItemDefaults:h,createGroupDefaults:h,createAttributeSetter:v,createAttributeSetters:b};var _,j,w={exports:{}},k={};var C=(j||(j=1,w.exports=function(){if(_)return k;_=1;var e=l,t=Symbol.for("react.element"),o=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(e,l,o){var s,a={},c=null,d=null;for(s in void 0!==o&&(c=""+o),void 0!==l.key&&(c=""+l.key),void 0!==l.ref&&(d=l.ref),l)r.call(l,s)&&!i.hasOwnProperty(s)&&(a[s]=l[s]);if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===a[s]&&(a[s]=l[s]);return{$$typeof:t,type:e,key:c,ref:d,props:a,_owner:n.current}}return k.Fragment=o,k.jsx=s,k.jsxs=s,k}()),w.exports);const S=e=>{const t=(new DOMParser).parseFromString(e,"image/svg+xml").querySelector("svg");if(!t)return null;const l={};for(const{name:o,value:r}of t.attributes)l["class"===o?"className":o]=r;return C.jsx("svg",{...l,dangerouslySetInnerHTML:{__html:t.innerHTML}})},F=({type:e,children:t,className:l=""})=>C.jsx("div",{className:`siteforge-field-control siteforge-${e}-control ${l}`.trim(),children:t}),B=({label:e,help:t})=>C.jsxs(C.Fragment,{children:[e&&C.jsx("label",{className:"siteforge-field-label",children:e}),t&&C.jsx("p",{className:"siteforge-field-help",children:t})]});let N={};const T=e=>N[e]||null,E=(e,t,l)=>e?Object.entries(e).map(([e,o])=>((e,t,l,o)=>{const r=N[t.type];return r?C.jsx(r,{field:f(e,t),value:l,onChange:o},e):(console.warn(`[SiteForge] Unknown sub-field type: ${t.type}`),null)})(e,o,null==t?void 0:t[e],t=>l(e,t))):null,L=({field:e,value:t,onChange:l})=>{var o,n,i;return C.jsx(F,{type:"text",children:C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:e.label,value:t||"",onChange:l,placeholder:(null==(o=e.config)?void 0:o.placeholder)||"",help:(null==(n=e.config)?void 0:n.help)||"",required:(null==(i=e.config)?void 0:i.required)||!1})})},M=({field:e,value:t,onChange:l})=>{var o,n,i;return C.jsx(F,{type:"textarea",children:C.jsx(r.TextareaControl,{__nextHasNoMarginBottom:!0,label:e.label,value:t||"",onChange:l,placeholder:(null==(o=e.config)?void 0:o.placeholder)||"",rows:(null==(n=e.config)?void 0:n.rows)||4,help:(null==(i=e.config)?void 0:i.help)||""})})},I=({field:e,value:l,onChange:o})=>{var r,i;return C.jsxs(F,{type:"wysiwyg",children:[C.jsx(B,{label:e.label,help:null==(r=e.config)?void 0:r.help}),C.jsx(n.RichText,{tagName:"div",value:l||"",onChange:o,placeholder:(null==(i=e.config)?void 0:i.placeholder)||t.__("Enter content...","siteforge")})]})},A=({field:e,value:t,onChange:l})=>{const o=e.config||{};return C.jsx(F,{type:"number",children:C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:e.label,type:"number",value:void 0!==t?t:"",onChange:e=>l(e?Number(e):""),min:o.min,max:o.max,step:o.step||1,help:o.help||""})})},H=({field:e,value:t,onChange:l})=>{const o=e.config||{};return C.jsx(F,{type:"range",children:C.jsx(r.RangeControl,{label:e.label,value:t??o.default??50,onChange:l,min:o.min??0,max:o.max??100,step:o.step||1,help:o.help||""})})},O=({field:e,value:t,onChange:l})=>{var o,n;return C.jsx(F,{type:"url",children:C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:e.label,type:"url",value:t||"",onChange:l,placeholder:(null==(o=e.config)?void 0:o.placeholder)||"https://",help:(null==(n=e.config)?void 0:n.help)||""})})},P=({field:e,value:t,onChange:l})=>{var o,n;return C.jsx(F,{type:"email",children:C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:e.label,type:"email",value:t||"",onChange:l,placeholder:(null==(o=e.config)?void 0:o.placeholder)||"email@example.com",help:(null==(n=e.config)?void 0:n.help)||""})})},R=({field:e,value:t,onChange:l})=>{var o,n,i;const s=(null==(o=e.config)?void 0:o.choices)||{},a=Object.entries(s).map(([e,t])=>({value:e,label:t}));return C.jsx(F,{type:"select",children:C.jsx(r.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:e.label,value:t||(null==(n=e.config)?void 0:n.default)||"",options:a,onChange:l,help:(null==(i=e.config)?void 0:i.help)||""})})},$=({field:e,value:t,onChange:l})=>{var o;return C.jsx(F,{type:"checkbox",children:C.jsx(r.CheckboxControl,{__nextHasNoMarginBottom:!0,label:e.label,checked:t||!1,onChange:l,help:(null==(o=e.config)?void 0:o.help)||""})})},z=$,D=({field:e,value:t,onChange:l})=>{var o,n;return C.jsxs(F,{type:"color",children:[C.jsx(B,{label:e.label,help:null==(o=e.config)?void 0:o.help}),C.jsx(r.ColorPicker,{color:t||(null==(n=e.config)?void 0:n.default)||"#000000",onChangeComplete:e=>l(e.hex)})]})},U=({field:e,value:l,onChange:o})=>{var i,s;const a=(null==(i=e.config)?void 0:i.return_value)||"url",c=u.getUrl(l);return C.jsxs(F,{type:"image",children:[C.jsx(B,{label:e.label,help:null==(s=e.config)?void 0:s.help}),C.jsx(n.MediaUploadCheck,{children:C.jsx(n.MediaUpload,{onSelect:e=>{o(u.formatValue(e,a))},allowedTypes:["image"],value:u.getId(l),render:({open:l})=>C.jsxs("div",{className:"siteforge-image-field",children:[c&&C.jsx("img",{src:c,alt:e.label,className:"siteforge-image-preview",style:{maxWidth:"100%",height:"auto",marginBottom:"8px"}}),C.jsxs("div",{className:"siteforge-image-buttons",children:[C.jsx(r.Button,{variant:"secondary",onClick:l,children:c?t.__("Change Image","siteforge"):t.__("Select Image","siteforge")}),c&&C.jsx(r.Button,{variant:"link",isDestructive:!0,onClick:()=>o(""),style:{marginLeft:"8px"},children:t.__("Remove","siteforge")})]})]})})})]})},W=({field:e,value:l,onChange:o})=>{var i,s,a;const c=(null==(i=e.config)?void 0:i.return_value)||"url",d=u.getUrl(l),p=d?d.split("/").pop():"";return C.jsxs(F,{type:"file",children:[C.jsx(B,{label:e.label,help:null==(s=e.config)?void 0:s.help}),C.jsx(n.MediaUploadCheck,{children:C.jsx(n.MediaUpload,{onSelect:e=>{o(u.formatValue(e,c))},allowedTypes:null==(a=e.config)?void 0:a.allowed_types,value:u.getId(l),render:({open:e})=>C.jsxs("div",{className:"siteforge-file-field",children:[d&&C.jsx("div",{className:"siteforge-file-info",style:{marginBottom:"8px"},children:C.jsx("span",{children:p})}),C.jsxs("div",{className:"siteforge-file-buttons",children:[C.jsx(r.Button,{variant:"secondary",onClick:e,children:d?t.__("Change File","siteforge"):t.__("Select File","siteforge")}),d&&C.jsx(r.Button,{variant:"link",isDestructive:!0,onClick:()=>o(""),style:{marginLeft:"8px"},children:t.__("Remove","siteforge")})]})]})})})]})},V=({field:e,value:l,onChange:n})=>{var s;const[a,c]=o.useState([]),[d,p]=o.useState(!0),[u,g]=o.useState(""),[f,h]=o.useState(!1);o.useEffect(()=>{(async()=>{try{const e=await i({path:"/siteforge/v1/icons"});c(e.icons||[])}catch(e){console.error("[SiteForge] Error loading icons:",e),c([])}p(!1)})()},[]);const m=a.filter(e=>e.toLowerCase().includes(u.toLowerCase())),x=(null==(s=window.siteforgeConfig)?void 0:s.spriteUrl)||"",v=e.config||{};return C.jsxs(F,{type:"icon",children:[C.jsx(B,{label:e.label,help:v.help}),C.jsxs("div",{className:"siteforge-icon-field",children:[C.jsxs("div",{className:"siteforge-icon-selected",style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[l&&x&&C.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",style:{display:"inline-block",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},"aria-hidden":"true",children:C.jsx("use",{href:`${x}#${l}`})}),C.jsx("span",{style:{color:l?"inherit":"#757575"},children:l||t.__("Aucune icÃ´ne sÃ©lectionnÃ©e","siteforge")})]}),C.jsxs("div",{className:"siteforge-icon-buttons",style:{display:"flex",gap:"8px"},children:[C.jsx(r.Button,{variant:"secondary",onClick:()=>h(!f),children:f?t.__("Fermer","siteforge"):t.__("Choisir une icÃ´ne","siteforge")}),l&&C.jsx(r.Button,{variant:"link",isDestructive:!0,onClick:()=>n(""),children:t.__("Supprimer","siteforge")})]}),f&&C.jsxs("div",{className:"siteforge-icon-picker",style:{marginTop:"12px",padding:"12px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#fff"},children:[C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,placeholder:t.__("Rechercher une icÃ´ne...","siteforge"),value:u,onChange:g,style:{marginBottom:"12px"}}),d?C.jsx("div",{style:{textAlign:"center",padding:"20px"},children:C.jsx(r.Spinner,{})}):C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"siteforge-icon-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(40px, 1fr))",gap:"4px",maxHeight:"250px",overflowY:"auto",padding:"4px"},children:m.slice(0,200).map(e=>C.jsx("button",{type:"button",title:e,onClick:()=>{n(e),h(!1),g("")},style:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",padding:"8px",border:l===e?"2px solid #007cba":"1px solid #ddd",borderRadius:"4px",backgroundColor:l===e?"#f0f7fc":"#fff",cursor:"pointer",transition:"all 0.15s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f5f5f5",e.currentTarget.style.borderColor="#007cba"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=l===e?"#f0f7fc":"#fff",t.currentTarget.style.borderColor=l===e?"#007cba":"#ddd"},children:x?C.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",style:{fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},"aria-hidden":"true",children:C.jsx("use",{href:`${x}#${e}`})}):C.jsx("span",{style:{fontSize:"10px"},children:e.slice(0,3)})},e))}),C.jsx("p",{style:{marginTop:"8px",fontSize:"12px",color:"#757575"},children:m.length>200?`${t.__("Affichage des 200 premiers sur","siteforge")} ${m.length} ${t.__("icÃ´nes","siteforge")}`:`${m.length} ${t.__("icÃ´ne(s) trouvÃ©e(s)","siteforge")}`})]})]})]})]})},q=({field:e,value:l,onChange:n})=>{const s=e.config||{},a=s.modes||["link","page","phone","email"],c=s.default_mode||a[0],d=l||{mode:c,label:"",url:"",postId:null,postTitle:"",phone:"",email:"",target:"_self"},[p,u]=o.useState([]),[g,f]=o.useState(!1),[h,m]=o.useState(d.postTitle||""),x=(e,t)=>{n({...d,[e]:t})};o.useEffect(()=>{const e=setTimeout(()=>{"page"===d.mode&&(async e=>{if(!e||e.length<2)u([]);else{f(!0);try{const t=s.post_types||["post","page"],l=await i({path:`/wp/v2/search?search=${encodeURIComponent(e)}&type=post&subtype=${t.join(",")}&per_page=10`});u(l.map(e=>({value:e.id,label:`${e.title} (${e.subtype})`,title:e.title})))}catch(t){console.error("[SiteForge] Search error:",t),u([])}f(!1)}})(h)},300);return()=>clearTimeout(e)},[h,d.mode]);const v={link:t.__("Lien","siteforge"),page:t.__("Page","siteforge"),phone:t.__("TÃ©lÃ©phone","siteforge"),email:t.__("Email","siteforge")},b={link:"ðŸ”—",page:"ðŸ“„",phone:"ðŸ“ž",email:"âœ‰ï¸"};return C.jsxs(F,{type:"link",children:[C.jsx(B,{label:e.label,help:s.help}),C.jsx("div",{className:"siteforge-link-modes",style:{marginBottom:"12px"},children:C.jsx(r.ButtonGroup,{children:a.map(e=>C.jsxs(r.Button,{variant:d.mode===e?"primary":"secondary",onClick:()=>x("mode",e),size:"small",children:[b[e]," ",v[e]]},e))})}),C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:t.__("Texte du lien","siteforge"),value:d.label||"",onChange:e=>x("label",e),placeholder:t.__("Texte Ã  afficher...","siteforge")}),"link"===d.mode&&C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:t.__("URL","siteforge"),type:"url",value:d.url||"",onChange:e=>x("url",e),placeholder:"https://..."}),"page"===d.mode&&C.jsxs(r.BaseControl,{label:t.__("Rechercher une page","siteforge"),children:[C.jsx(r.ComboboxControl,{value:d.postId,onChange:e=>{const t=p.find(t=>t.value===e);x("postId",e),t&&(x("postTitle",t.title),d.label||x("label",t.title))},options:p,onFilterValueChange:e=>m(e),placeholder:t.__("Tapez pour rechercher...","siteforge")}),g&&C.jsx(r.Spinner,{}),d.postId&&d.postTitle&&C.jsxs("p",{style:{marginTop:"4px",color:"#757575",fontSize:"12px"},children:[t.__("SÃ©lectionnÃ©:","siteforge")," ",C.jsx("strong",{children:d.postTitle})," (ID: ",d.postId,")"]})]}),"phone"===d.mode&&C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:t.__("NumÃ©ro de tÃ©lÃ©phone","siteforge"),type:"tel",value:d.phone||"",onChange:e=>x("phone",e),placeholder:"+33 1 23 45 67 89"}),"email"===d.mode&&C.jsx(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:t.__("Adresse email","siteforge"),type:"email",value:d.email||"",onChange:e=>x("email",e),placeholder:"contact@example.com"}),("link"===d.mode||"page"===d.mode)&&C.jsx(r.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:t.__("Ouvrir dans","siteforge"),value:d.target||"_self",options:[{value:"_self",label:t.__("MÃªme fenÃªtre","siteforge")},{value:"_blank",label:t.__("Nouvel onglet","siteforge")}],onChange:e=>x("target",e)})]})},J=({field:e,value:l,onChange:n})=>{const i=Array.isArray(l)?l:[],s=e.config||{},a=s.fields||s.sub_fields,[c,d]=o.useState(()=>{const e={};return i.forEach((t,l)=>{e[l]=!0}),e}),u=e=>{d(t=>({...t,[e]:!t[e]}))},g=(e,t)=>{n(p.move(i,e,t)),d(l=>({...l,[e]:l[t],[t]:l[e]}))};return C.jsxs(F,{type:"repeater",children:[C.jsx(B,{label:e.label,help:s.help}),C.jsx("div",{className:"siteforge-repeater-items",children:i.map((e,l)=>{const o=!1!==c[l],s=o?"":(e=>{if(!e||!a)return"";const t=["title","name","label","quote","text","heading"];for(const l of t)if(e[l]&&"string"==typeof e[l])return e[l].substring(0,50)+(e[l].length>50?"...":"");for(const[l,o]of Object.entries(e))if("string"==typeof o&&o.trim())return o.substring(0,50)+(o.length>50?"...":"");return""})(e);return C.jsxs("div",{className:"siteforge-repeater-item "+(o?"is-open":"is-collapsed"),children:[C.jsxs("div",{className:"siteforge-repeater-item-header",onClick:()=>u(l),style:{cursor:"pointer"},children:[C.jsx(r.Button,{variant:"tertiary",icon:o?"arrow-down":"arrow-right",onClick:e=>{e.stopPropagation(),u(l)},label:o?t.__("Collapse","siteforge"):t.__("Expand","siteforge"),size:"small",style:{marginRight:"4px"}}),C.jsxs("span",{className:"siteforge-repeater-item-title",children:[t.__("Item","siteforge")," ",l+1,s&&C.jsxs("span",{style:{marginLeft:"8px",color:"#757575",fontWeight:"normal",fontSize:"12px"},children:["â€” ",s]})]}),C.jsxs("div",{className:"siteforge-repeater-item-actions",onClick:e=>e.stopPropagation(),children:[l>0&&C.jsx(r.Button,{variant:"tertiary",icon:S('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-to-line-icon lucide-arrow-up-to-line"><path d="M5 3h14"/><path d="m18 13-6-6-6 6"/><path d="M12 7v14"/></svg>'),onClick:()=>g(l,l-1),label:t.__("Move up","siteforge"),size:"small"}),l<i.length-1&&C.jsx(r.Button,{variant:"tertiary",icon:S('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-to-line-icon lucide-arrow-down-to-line"><path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/></svg>'),onClick:()=>g(l,l+1),label:t.__("Move down","siteforge"),size:"small"}),C.jsx(r.Button,{variant:"tertiary",isDestructive:!0,icon:S('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-icon lucide-trash"><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>'),onClick:()=>(e=>{n(p.remove(i,e)),d(t=>{const l={...t};delete l[e];const o={};return Object.keys(l).forEach(t=>{const r=parseInt(t,10);r>e?o[r-1]=l[t]:o[r]=l[t]}),o})})(l),label:t.__("Remove","siteforge"),size:"small"})]})]}),o&&C.jsx("div",{className:"siteforge-repeater-item-fields",children:E(a,e,(t,o)=>{((e,t)=>{n(p.update(i,e,t))})(l,{...e,[t]:o})})})]},l)})}),C.jsx(r.Button,{variant:"secondary",onClick:()=>{const e=h(a),t=i.length;n(p.add(i,e)),d(e=>({...e,[t]:!0}))},className:"siteforge-repeater-add",children:s.button_label||t.__("Add Item","siteforge")})]})},G=({field:e,value:t,onChange:l})=>{const o=t||{},r=e.config||{},n=r.fields||r.sub_fields;return C.jsxs(F,{type:"group",children:[C.jsx(B,{label:e.label,help:r.help}),C.jsx("div",{className:"siteforge-group-fields",children:E(n,o,(e,t)=>{l({...o,[e]:t})})})]})};N={text:L,textarea:M,wysiwyg:I,image:U,file:W,select:R,checkbox:$,toggle:z,link:q,icon:V,button:({field:e,value:l,onChange:n})=>{var s;const a=e.config||{},[c,d]=o.useState([]),[p,u]=o.useState([]),[g,f]=o.useState(!0),h=l||{link:{mode:a.default_mode||"link",label:"",url:"",postId:null,postTitle:"",phone:"",email:"",target:"_self"},icon:"",iconPosition:"after",style:"btn-primary"};o.useEffect(()=>{(async()=>{try{const e=await i({path:"/siteforge/v1/button-styles"}),t=Array.isArray(e)?e:[];u(t),d(t.map(e=>({value:e.name,label:e.label||e.name.replace("btn-","")})))}catch(e){console.error("[SiteForge] Error loading button styles:",e),d([{value:"btn-primary",label:"Primaire"}]),u([])}f(!1)})()},[]);const m=e=>{const t=p.find(t=>t.name===e);return(null==t?void 0:t.variables)||{}},x=()=>"false"!==m(h.style).icon,v=(e,t)=>{n({...h,[e]:t})},b=(null==(s=window.siteforgeConfig)?void 0:s.spriteUrl)||"";return C.jsxs(F,{type:"button",children:[C.jsx(B,{label:e.label,help:a.help}),C.jsx("div",{style:{marginBottom:"16px"},children:g?C.jsx(r.Spinner,{}):C.jsx(r.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:t.__("Style du bouton","siteforge"),value:h.style,options:c,onChange:e=>{var t;const l=(null==(t=p.find(t=>t.name===e))?void 0:t.variables)||{},o={...h,style:e};l["icon-position"]&&(o.iconPosition=l["icon-position"]),l["icon-default"]&&!h.icon&&(o.icon=l["icon-default"]),n(o)}})}),C.jsx("div",{style:{marginBottom:"16px",padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"4px"},children:C.jsx(q,{field:{...e,label:t.__("Lien","siteforge"),config:{...a,modes:a.modes||["link","page","phone","email"]}},value:h.link,onChange:e=>{n({...h,link:e})}})}),x()&&C.jsxs("div",{style:{marginBottom:"16px"},children:[C.jsx(B,{label:t.__("IcÃ´ne","siteforge")}),C.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[h.icon&&b&&C.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",style:{fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},children:C.jsx("use",{href:`${b}#${h.icon}`})}),C.jsx("span",{style:{color:h.icon?"inherit":"#757575"},children:h.icon||t.__("Aucune icÃ´ne","siteforge")}),h.icon&&C.jsx(r.Button,{variant:"link",isDestructive:!0,onClick:()=>v("icon",""),size:"small",children:t.__("Supprimer","siteforge")})]}),C.jsx(V,{field:{...e,label:"",config:{}},value:h.icon,onChange:e=>v("icon",e)}),h.icon&&"false"!==m(h.style)["icon-move"]&&C.jsxs("div",{style:{marginTop:"12px"},children:[C.jsx(B,{label:t.__("Position de l'icÃ´ne","siteforge")}),C.jsxs(r.ButtonGroup,{children:[C.jsx(r.Button,{variant:"before"===h.iconPosition?"primary":"secondary",onClick:()=>v("iconPosition","before"),size:"small",children:t.__("Avant","siteforge")}),C.jsx(r.Button,{variant:"after"===h.iconPosition?"primary":"secondary",onClick:()=>v("iconPosition","after"),size:"small",children:t.__("AprÃ¨s","siteforge")})]})]})]}),!x()&&C.jsx("p",{style:{fontSize:"12px",color:"#757575",fontStyle:"italic"},children:t.__("Les icÃ´nes sont dÃ©sactivÃ©es pour ce style de bouton.","siteforge")})]})},repeater:J,group:G,number:A,range:H,url:O,email:P,color:D};const Y=N,K=({field:e})=>C.jsxs("div",{className:"siteforge-error",children:[C.jsxs("p",{className:"siteforge-error-title",children:[t.__("Error","siteforge"),": ",t.__("Unknown field type","siteforge")]}),C.jsxs("p",{children:[t.__("Field","siteforge"),": ",C.jsx("code",{children:e.name}),C.jsx("br",{}),t.__("Type","siteforge"),": ",C.jsx("code",{children:e.type})]})]}),Q=(e,t,l)=>e.map(e=>((e,t,l)=>{const o=Y[e.type];return o?C.jsx(o,{field:e,value:t[e.name],onChange:t=>l({[e.name]:t})},e.name):(console.warn(`[SiteForge] Unknown field type: ${e.type} for field: ${e.name}`),C.jsx(K,{field:e},e.name))})(e,t,l)),X=(e,l,o,i=null)=>{const s=c(e);if(!s)return null;const a=i||t.__("Block Settings","siteforge");return C.jsx(n.InspectorControls,{children:C.jsx(r.PanelBody,{title:a,initialOpen:!0,children:Q(s,l,o)})})},Z=(e,t,l,o)=>{const i=c(e);return i?C.jsx(n.InspectorControls,{children:Object.entries(o).map(([e,o])=>{const n=i.filter(e=>o.fields.includes(e.name));return 0===n.length?null:C.jsx(r.PanelBody,{title:o.title,initialOpen:void 0===o.initialOpen||o.initialOpen,children:Q(n,t,l)},e)})}):null},ee=(e,t,l,o)=>{const i=c(e);if(!i)return null;const{TabPanel:s}=wp.components,a=o.map(e=>({name:e.name,title:e.title,icon:e.icon,className:`siteforge-tab-${e.name}`}));return C.jsx(n.InspectorControls,{children:C.jsx(s,{tabs:a,children:e=>{const n=o.find(t=>t.name===e.name),s=i.filter(e=>n.fields.includes(e.name));return C.jsx(r.PanelBody,{children:Q(s,t,l)})}})})},te=e=>{const t=c(e);return t?{hasFields:!0,fieldCount:t.length,fieldNames:t.map(e=>e.name),fields:t,getField:e=>t.find(t=>t.name===e)||null}:{hasFields:!1,fieldCount:0,fieldNames:[],fields:[],getField:()=>null}},le=(e,t)=>{const l={};return t.forEach(t=>{const o=`set${t.charAt(0).toUpperCase()}${t.slice(1)}`;l[o]=l=>e({[t]:l})}),l},oe=({blockName:e,attributes:t,setAttributes:l,panelTitle:o,sections:r,children:n})=>{const i=r?Z(e,t,l,r):X(e,t,l,o);return C.jsxs(C.Fragment,{children:[i,n]})},re=({container:e,allowedBlocks:t,template:l,templateLock:r})=>e?o.createPortal(o.createElement(n.InnerBlocks,{allowedBlocks:t,template:l,templateLock:r}),e):null,ne=({attributes:e,setAttributes:l,blockName:i,clientId:s})=>{const c=o.useRef(null),[d,p]=o.useState(null),[u,g]=o.useState(null),f=X(i,e,l),h=n.useBlockProps({className:"siteforge-block-editor-wrapper",ref:c});return o.useEffect(()=>{if(!c.current)return;const e=e=>{const t=document.createElement("textarea");return t.innerHTML=e,t.value},t=new MutationObserver(()=>{const t=c.current.querySelector(".sf-inner-blocks");if(t&&t!==d){let o,r;try{const l=t.getAttribute("data-allowed-blocks"),n=t.getAttribute("data-template");o=l?JSON.parse(e(l)):void 0,r=n?JSON.parse(e(n)):void 0}catch(l){console.error("[SiteForge] Error parsing InnerBlocks config:",l)}const n={allowedBlocks:o,template:r,templateLock:"false"!==t.dataset.templateLock&&(t.dataset.templateLock||!1)};t.dataset.processed||(t.dataset.processed="true",g(n),p(t))}});t.observe(c.current,{childList:!0,subtree:!0});const l=c.current.querySelector(".sf-inner-blocks");if(l){let t,r;try{const o=l.getAttribute("data-allowed-blocks"),n=l.getAttribute("data-template");t=o?JSON.parse(e(o)):void 0,r=n?JSON.parse(e(n)):void 0}catch(o){console.error("[SiteForge] Error parsing initial InnerBlocks config:",o)}const n={allowedBlocks:t,template:r,templateLock:"false"!==l.dataset.templateLock&&(l.dataset.templateLock||!1)};l.dataset.processed||(l.dataset.processed="true",g(n),p(l))}return()=>t.disconnect()},[]),o.createElement(o.Fragment,null,[f,o.createElement("div",h,[o.createElement(a.ServerSideRender,{key:"server-side-render",block:i,attributes:e,httpMethod:"POST",LoadingResponsePlaceholder:()=>o.createElement(r.Placeholder,{icon:"block-default",label:t.__("Chargement...","siteforge")},o.createElement(r.Spinner)),ErrorResponsePlaceholder:({response:e})=>o.createElement(r.Placeholder,{icon:"warning",label:t.__("Erreur de rendu","siteforge")},o.createElement("div",{style:{color:"#d94f4f"}},(null==e?void 0:e.message)||t.__("Impossible de charger le bloc","siteforge")))})]),d&&u&&o.createElement(re,{key:"inner-blocks-portal",container:d,allowedBlocks:u.allowedBlocks,template:u.template,templateLock:u.templateLock})])},ie=()=>o.createElement(n.InnerBlocks.Content),se=()=>{if(void 0===window.siteforgeBlocks)return void console.warn("[SiteForge] No blocks to register");const e=window.siteforgeBlocks;Object.keys(e).forEach(t=>{const l=e[t];if(wp.blocks.getBlockType(t))return void console.log(`[SiteForge] Block ${t} already registered in JavaScript, skipping`);console.log(`[SiteForge] Registering block ${t}...`);const r={};l.fields&&Array.isArray(l.fields)&&l.fields.forEach(e=>{const t=e.config||{};let l="string";const o={text:"string",textarea:"string",wysiwyg:"string",select:"string",checkbox:"boolean",number:"number",range:"number",url:"string",email:"string",color:"string",icon:"string",link:"object",repeater:"array",group:"object"};if(o[e.type]&&(l=o[e.type]),"image"===e.type){const e=t.return_value||"url";l="id"===e?"number":"object"===e?"object":"string"}r[e.name]={type:l},void 0!==t.default?r[e.name].default=t.default:"object"===l?r[e.name].default={}:"array"===l&&(r[e.name].default=[])});try{s.registerBlockType(t,{title:l.title||t,description:l.description||"",category:"siteforge",icon:l.icon||"block-default",supports:l.supports||{align:!0,anchor:!0,spacing:{margin:!0,padding:!0}},attributes:r,edit:e=>o.createElement(ne,{...e,blockName:t}),save:ie}),console.log(`[SiteForge] âœ… Block ${t} registered with ${Object.keys(r).length} attributes`)}catch(n){console.error(`[SiteForge] âŒ Failed to register block ${t}:`,n)}})};return"undefined"!=typeof wp&&void 0!==wp.blocks?se():console.warn("[SiteForge] WordPress blocks API not available"),window.SiteForge=window.SiteForge||{},window.SiteForge.helpers=y,window.SiteForge.getBlockFields=c,window.SiteForge.getBlockData=d,window.SiteForge.arrayHelpers=p,window.SiteForge.imageHelpers=u,window.SiteForge.objectHelpers=g,window.SiteForge.styleHelpers=m,window.SiteForge.FieldControls=Y,window.SiteForge.getFieldComponent=T,window.SiteForge.FieldWrapper=F,window.SiteForge.FieldLabel=B,window.SiteForge.createFieldControls=X,window.SiteForge.createSectionedFieldControls=Z,window.SiteForge.createTabbedFieldControls=ee,window.SiteForge.useSiteForgeFields=te,window.SiteForge.useAttributeSetters=le,window.SiteForge.SiteForgeBlockControls=oe,window.SiteForge.registerSiteForgeBlocks=se,window.siteforgeBlocks&&("undefined"!=typeof wp&&void 0!==wp.domReady?wp.domReady(()=>{se()}):window.addEventListener("load",()=>{se()})),e.CheckboxField=$,e.ColorField=D,e.EmailField=P,e.FieldControls=Y,e.FieldLabel=B,e.FieldWrapper=F,e.FileField=W,e.GroupField=G,e.ImageField=U,e.NumberField=A,e.RangeField=H,e.RepeaterField=J,e.SelectField=R,e.SiteForgeBlockControls=oe,e.TextField=L,e.TextareaField=M,e.ToggleField=z,e.UrlField=O,e.WysiwygField=I,e.arrayHelpers=p,e.createAttributeSetter=v,e.createAttributeSetters=b,e.createFieldControls=X,e.createRepeaterItemDefaults=h,e.createSectionedFieldControls=Z,e.createTabbedFieldControls=ee,e.default=X,e.getBlockData=d,e.getBlockFields=c,e.getFieldComponent=T,e.helpers=y,e.imageHelpers=u,e.normalizeField=f,e.objectHelpers=g,e.registerSiteForgeBlocks=se,e.renderSubFields=E,e.styleHelpers=m,e.useAttributeSetters=le,e.useSiteForgeFields=te,e.validationHelpers=x,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),e}({},wp.i18n,React,wp.element,wp.components,wp.blockEditor,wp.apiFetch,wp.blocks,wp.serverSideRender);
//# sourceMappingURL=editor.js.map
