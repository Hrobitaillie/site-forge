!function(e,s,t,r,o){"use strict";var n,i,c={exports:{}},l={};var a=(i||(i=1,c.exports=function(){if(n)return l;n=1;var s=e,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(e,s,r){var n,l={},a=null,d=null;for(n in void 0!==r&&(a=""+r),void 0!==s.key&&(a=""+s.key),void 0!==s.ref&&(d=s.ref),s)o.call(s,n)&&!c.hasOwnProperty(n)&&(l[n]=s[n]);if(e&&e.defaultProps)for(n in s=e.defaultProps)void 0===l[n]&&(l[n]=s[n]);return{$$typeof:t,type:e,key:a,ref:d,props:l,_owner:i.current}}return l.Fragment=r,l.jsx=a,l.jsxs=a,l}()),c.exports);const d=e=>{const s=(new DOMParser).parseFromString(e,"image/svg+xml").querySelector("svg");if(!s)return null;const t={};for(const{name:r,value:o}of s.attributes)t["class"===r?"className":r]=o;return a.jsx("svg",{...t,dangerouslySetInnerHTML:{__html:s.innerHTML}})},u={colors:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-palette-icon lucide-palette"><path d="M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z"/><circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/><circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/><circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/><circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/></svg>',typography:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-case-sensitive-icon lucide-case-sensitive"><path d="m2 16 4.039-9.69a.5.5 0 0 1 .923 0L11 16"/><path d="M22 9v7"/><path d="M3.304 13h6.392"/><circle cx="18.5" cy="12.5" r="3.5"/></svg>',spacing:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-top-bottom-dashed-icon lucide-panel-top-bottom-dashed"><path d="M14 15h1"/><path d="M14 9h1"/><path d="M19 15h2"/><path d="M19 9h2"/><path d="M3 15h2"/><path d="M3 9h2"/><path d="M9 15h1"/><path d="M9 9h1"/><rect x="3" y="3" width="18" height="18" rx="2"/></svg>'};function h({pages:e,currentPage:s,onNavigate:r}){var n;return a.jsxs("aside",{className:"siteforge-admin-sidebar",children:[a.jsxs("div",{className:"siteforge-sidebar-header",children:[a.jsx("div",{className:"siteforge-sidebar-logo",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),a.jsx("circle",{cx:"8",cy:"8",r:"2",fill:"currentColor"}),a.jsx("circle",{cx:"16",cy:"8",r:"2",fill:"currentColor"}),a.jsx("circle",{cx:"8",cy:"16",r:"2",fill:"currentColor"}),a.jsx("circle",{cx:"16",cy:"16",r:"2",fill:"currentColor"})]})}),a.jsx("span",{className:"siteforge-sidebar-title",children:t.__("Design System","siteforge")})]}),a.jsx("nav",{className:"siteforge-sidebar-nav",children:a.jsx("ul",{children:Object.entries(e).map(([e,t])=>a.jsx("li",{children:a.jsxs("button",{className:"siteforge-sidebar-item "+(s===e?"is-active":""),onClick:()=>r(e),type:"button",children:[u[e]&&a.jsx(o.Icon,{icon:d(u[e]),size:20}),a.jsx("span",{children:t.label})]})},e))})}),a.jsx("div",{className:"siteforge-sidebar-footer",children:a.jsx("p",{className:"siteforge-sidebar-theme",children:(null==(n=window.siteforgeDesignSystem)?void 0:n.themeName)||"Theme"})})]})}function g(e){if(!e||"string"!=typeof e)return null;const s=e.match(/oklch\s*\(\s*([\d.]+)\s+([\d.]+)\s+([\d.]+)\s*\)/i);return s?{l:parseFloat(s[1]),c:parseFloat(s[2]),h:parseFloat(s[3])}:null}function f({l:e,c:s,h:t}){return`oklch(${Math.round(100*e)/100} ${Math.round(1e3*s)/1e3} ${Math.round(t)})`}function p(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function m(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}function x(e){return Math.max(0,Math.min(1,e))}function v(e){const s=g(e);if(!s)return"#808080";const{l:t,c:r,h:o}=s,n=function(e,s,t){const r=t*Math.PI/180;return{L:e,a:s*Math.cos(r),b:s*Math.sin(r)}}(t,r,o),i=function(e,s,t){const r=e+.3963377774*s+.2158037573*t,o=e-.1055613458*s-.0638541728*t,n=e-.0894841775*s-1.291485548*t,i=r*r*r,c=o*o*o,l=n*n*n;return{r:4.0767416621*i-3.3077115913*c+.2309699292*l,g:-1.2684380046*i+2.6097574011*c-.3413193965*l,b:-.0041960863*i-.7034186147*c+1.707614701*l}}(n.L,n.a,n.b),c=Math.round(255*x(m(i.r))),l=Math.round(255*x(m(i.g))),a=Math.round(255*x(m(i.b)));return`#${c.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`}function j(e){let s,t,r;if(3===(e=e.replace(/^#/,"")).length)s=parseInt(e[0]+e[0],16)/255,t=parseInt(e[1]+e[1],16)/255,r=parseInt(e[2]+e[2],16)/255;else{if(6!==e.length)return"oklch(0.5 0.15 250)";s=parseInt(e.slice(0,2),16)/255,t=parseInt(e.slice(2,4),16)/255,r=parseInt(e.slice(4,6),16)/255}const o=function(e,s,t){const r=.4122214708*e+.5363325363*s+.0514459929*t,o=.2119034982*e+.6806995451*s+.1073969566*t,n=.0883024619*e+.2817188376*s+.6299787005*t,i=Math.cbrt(r),c=Math.cbrt(o),l=Math.cbrt(n);return{L:.2104542553*i+.793617785*c-.0040720468*l,a:1.9779984951*i-2.428592205*c+.4505937099*l,b:.0259040371*i+.7827717662*c-.808675766*l}}(p(s),p(t),p(r)),n=function(e,s,t){const r=Math.sqrt(s*s+t*t);let o=180*Math.atan2(t,s)/Math.PI;return o<0&&(o+=360),{l:e,c:r,h:o}}(o.L,o.a,o.b);return f(n)}function w(e){const s=g(e);if(!s)return{};const{c:t,h:r}=s,o={50:.97,100:.93,200:.87,300:.77,400:.66,600:.48,700:.4,800:.32,900:.24,950:.16},n={50:.08,100:.16,200:.32,300:.56,400:.8,600:.88,700:.72,800:.56,900:.4,950:.24},i={};for(const[c,l]of Object.entries(o)){const e=t*n[c];i[c]=f({l:l,c:e,h:r})}return i}function _(e){return/^[a-z][a-z0-9-]*$/.test(e)}function k(e){let s=e.toLowerCase();return s=s.replace(/[\s_]+/g,"-"),s=s.replace(/[^a-z0-9-]/g,""),s=s.replace(/^[^a-z]+/,""),s=s.replace(/-+$/,""),s||"color"}function y(e){return!["success","warning","error","black","white"].includes(e)}function b({value:e,onChange:r}){const[n,i]=s.useState(()=>v(e)),[c,l]=s.useState(e);s.useEffect(()=>{i(v(e)),l(e)},[e]);return a.jsxs("div",{className:"siteforge-color-picker",children:[a.jsxs("div",{className:"siteforge-color-picker-native",children:[a.jsx("input",{type:"color",value:n,onChange:e=>{const s=e.target.value;i(s);const t=j(s);l(t),r(t)},className:"siteforge-color-input"}),a.jsx("div",{className:"siteforge-color-preview",style:{backgroundColor:n}})]}),a.jsxs("div",{className:"siteforge-color-picker-fields",children:[a.jsx(o.TextControl,{label:t.__("Hex","siteforge"),value:n,onChange:e=>{i(e);const s=e.replace(/^#/,"");if((3===s.length||6===s.length)&&/^[0-9a-fA-F]+$/.test(s)){const e=j(s);l(e),r(e)}},className:"siteforge-color-hex-input"}),a.jsx(o.TextControl,{label:t.__("OKLCH","siteforge"),value:c,onChange:e=>{l(e);g(e)&&(i(v(e)),r(e))},className:"siteforge-color-oklch-input",help:t.__("Format: oklch(L C H)","siteforge")})]})]})}function C({name:e,color:r,onDelete:n,onRename:i,onUpdateBase:c,onUpdateShade:l,onRegenerateShades:u,onToggleShades:h}){const[g,f]=s.useState(!1),[p,m]=s.useState(e),[x,v]=s.useState(null),j=s.useRef(null);s.useEffect(()=>{g&&j.current&&(j.current.focus(),j.current.select())},[g]);const w=()=>{if(p.trim()&&p!==e){i(p)||m(e)}else m(e);f(!1)},_=!!r.shades,k=[50,100,200,300,400,600,700,800,900,950],C=y(e);return a.jsxs("div",{className:"siteforge-color-card",children:[a.jsxs("div",{className:"siteforge-color-card-header",children:[a.jsx("div",{className:"siteforge-color-name",children:g?a.jsx("input",{ref:j,type:"text",value:p,onChange:e=>m(e.target.value),onBlur:w,onKeyDown:s=>{"Enter"===s.key?w():"Escape"===s.key&&(m(e),f(!1))},className:"siteforge-color-name-input"}):a.jsx("button",{type:"button",className:"siteforge-color-name-button",onClick:()=>f(!0),title:t.__("Cliquer pour modifier","siteforge"),children:e})}),a.jsx("div",{className:"siteforge-color-card-actions",children:a.jsx(o.Dropdown,{popoverProps:{placement:"bottom-end"},renderToggle:({isOpen:e,onToggle:s})=>a.jsx(o.Button,{icon:d('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-plus-icon lucide-circle-plus"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>'),onClick:s,"aria-expanded":e,label:t.__("Options","siteforge")}),renderContent:({onClose:e})=>a.jsxs(o.MenuGroup,{children:[C&&a.jsxs(a.Fragment,{children:[a.jsx(o.MenuItem,{icon:d(_?'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye-icon lucide-eye"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"/><circle cx="12" cy="12" r="3"/></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye-off-icon lucide-eye-off"><path d="M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49"/><path d="M14.084 14.158a3 3 0 0 1-4.242-4.242"/><path d="M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143"/><path d="m2 2 20 20"/></svg>'),onClick:()=>{h(),e()},children:_?t.__("Retirer les teintes","siteforge"):t.__("Ajouter les teintes","siteforge")}),_&&a.jsx(o.MenuItem,{icon:d('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw-icon lucide-refresh-cw"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>'),onClick:()=>{u(),e()},children:t.__("Régénérer les teintes","siteforge")})]}),a.jsx(o.MenuItem,{icon:d('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-icon lucide-trash"><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>'),isDestructive:!0,onClick:()=>{n(),e()},children:t.__("Supprimer","siteforge")})]})})})]}),a.jsxs("div",{className:"siteforge-color-swatches",children:[a.jsxs("div",{className:"siteforge-color-swatch-group siteforge-color-base-group",children:[a.jsx(N,{color:r.base,label:_?"500":t.__("Base","siteforge"),isBase:!0,isSelected:"base"===x,onSelect:()=>v("base"===x?null:"base")}),"base"===x&&a.jsx("div",{className:"siteforge-color-picker-popover",children:a.jsx(b,{value:r.base,onChange:e=>c(e)})})]}),_&&a.jsx("div",{className:"siteforge-color-shades",children:k.map(e=>{const s=r.shades[e];return s?a.jsxs("div",{className:"siteforge-color-swatch-group",children:[a.jsx(N,{color:s,label:String(e),isSelected:x===e,onSelect:()=>v(x===e?null:e)}),x===e&&a.jsx("div",{className:"siteforge-color-picker-popover",children:a.jsx(b,{value:s,onChange:s=>l(e,s)})})]},e):null})})]}),null!==x&&a.jsx("div",{className:"siteforge-color-picker-overlay",onClick:()=>v(null)})]})}function N({color:e,label:s,isBase:t,isSelected:r,onSelect:o}){const n=v(e),i=function(e){const s=parseInt(e.slice(1),16);return(.299*(s>>16&255)+.587*(s>>8&255)+.114*(255&s))/255>.5}(n);return a.jsx("button",{type:"button",className:`siteforge-color-swatch ${t?"is-base":""} ${r?"is-selected":""}`,style:{backgroundColor:n},onClick:o,title:`${s}: ${e}`,children:a.jsx("span",{className:"siteforge-swatch-label",style:{color:i?"#000":"#fff"},children:s})})}function S({colors:e,onChange:r}){const[n,i]=s.useState(!1),[c,l]=s.useState(""),[u,h]=s.useState("oklch(0.55 0.2 250)"),[g,f]=s.useState(!0),[p,m]=s.useState(""),x=Object.entries(e);return a.jsxs("div",{className:"siteforge-color-editor",children:[a.jsx("div",{className:"siteforge-color-list",children:0===x.length?a.jsxs("div",{className:"siteforge-color-empty",children:[a.jsx("p",{children:t.__("Aucune couleur définie.","siteforge")}),a.jsx("p",{children:t.__('Cliquez sur "Ajouter une couleur" pour commencer.',"siteforge")})]}):x.map(([s,o])=>a.jsx(C,{name:s,color:o,onDelete:()=>(s=>{if(!confirm(t.__("Supprimer cette couleur ?","siteforge")))return;const o={...e};delete o[s],r(o)})(s),onRename:t=>((s,t)=>{const o=k(t);if(!o||!_(o))return!1;if(o!==s&&e[o])return!1;if(o===s)return!0;const n={};for(const[r,i]of Object.entries(e))r===s?n[o]=i:n[r]=i;return r(n),!0})(s,t),onUpdateBase:t=>((s,t)=>{const o=e[s];if(!o)return;const n={...o,base:t};o.shades&&y(s)&&(n.shades=w(t)),r({...e,[s]:n})})(s,t),onUpdateShade:(t,o)=>((s,t,o)=>{const n=e[s];n&&n.shades&&r({...e,[s]:{...n,shades:{...n.shades,[t]:o}}})})(s,t,o),onRegenerateShades:()=>(s=>{const t=e[s];if(!t)return;const o=w(t.base);r({...e,[s]:{...t,shades:o}})})(s),onToggleShades:()=>(s=>{const t=e[s];if(t)if(t.shades){const{shades:o,...n}=t;r({...e,[s]:n})}else r({...e,[s]:{...t,shades:w(t.base)}})})(s)},s))}),a.jsx("div",{className:"siteforge-color-actions",children:a.jsx(o.Button,{variant:"secondary",icon:d('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-plus-icon lucide-circle-plus"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>'),onClick:()=>i(!0),children:t.__("Ajouter une couleur","siteforge")})}),n&&a.jsx(o.Modal,{title:t.__("Nouvelle couleur","siteforge"),onRequestClose:()=>{i(!1),m("")},className:"siteforge-add-color-modal",children:a.jsxs("div",{className:"siteforge-modal-content",children:[a.jsx(o.TextControl,{label:t.__("Nom de la couleur","siteforge"),value:c,onChange:e=>{l(e),m("")},placeholder:"primary, secondary, accent...",help:p||t.__("Lettres minuscules, chiffres et tirets uniquement.","siteforge"),className:p?"has-error":""}),a.jsxs("div",{className:"siteforge-color-picker-field",children:[a.jsx("label",{children:t.__("Couleur de base","siteforge")}),a.jsx(b,{value:u,onChange:h})]}),a.jsxs("div",{className:"siteforge-checkbox-field",children:[a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:g,onChange:e=>f(e.target.checked)}),t.__("Générer les teintes (50-950)","siteforge")]}),a.jsx("p",{className:"siteforge-field-help",children:t.__("Les couleurs utilitaires (success, warning, error) n'ont pas de teintes.","siteforge")})]}),a.jsxs("div",{className:"siteforge-modal-actions",children:[a.jsx(o.Button,{variant:"tertiary",onClick:()=>{i(!1),m("")},children:t.__("Annuler","siteforge")}),a.jsx(o.Button,{variant:"primary",onClick:()=>{const s=k(c);if(!s)return void m(t.__("Le nom est requis.","siteforge"));if(!_(s))return void m(t.__("Le nom doit commencer par une lettre et ne contenir que des lettres, chiffres et tirets.","siteforge"));if(e[s])return void m(t.__("Ce nom existe déjà.","siteforge"));const o={base:u};g&&y(s)&&(o.shades=w(u));const n={...e,[s]:o};r(n),i(!1),l(""),h("oklch(0.55 0.2 250)"),f(!0),m("")},children:t.__("Ajouter","siteforge")})]})]})})]})}const M={colors:{label:t.__("Couleurs","siteforge"),icon:"admin-appearance"}};function B(){var e;const[n,i]=s.useState("colors"),[c,l]=s.useState({}),[d,u]=s.useState(!0),[g,f]=s.useState(!1),[p,m]=s.useState(null),[x,v]=s.useState(null),[j,w]=s.useState(!1);s.useEffect(()=>{_()},[]);const _=async()=>{u(!0),m(null);try{const e=await r({path:"/siteforge/v1/design-system/colors"});e.success?l(e.colors||{}):m(t.__("Erreur lors du chargement des couleurs.","siteforge"))}catch(e){m(e.message||t.__("Erreur de connexion.","siteforge"))}finally{u(!1)}},k=e=>{l(e),w(!0)};return a.jsxs("div",{className:"siteforge-admin-layout",children:[a.jsx(h,{pages:M,currentPage:n,onNavigate:i}),a.jsxs("div",{className:"siteforge-admin-main",children:[a.jsxs("header",{className:"siteforge-admin-header",children:[a.jsxs("div",{className:"siteforge-admin-header-left",children:[a.jsx("h1",{children:(null==(e=M[n])?void 0:e.label)||t.__("Design System","siteforge")}),j&&a.jsx("span",{className:"siteforge-unsaved-badge",children:t.__("Non sauvegardé","siteforge")})]}),a.jsxs("div",{className:"siteforge-admin-header-actions",children:[a.jsx(o.Button,{variant:"tertiary",onClick:async()=>{if(confirm(t.__("Supprimer toutes les couleurs ? Cette action est irréversible.","siteforge"))){f(!0),m(null);try{const e=await r({path:"/siteforge/v1/design-system/reset-colors",method:"POST"});e.success?(l({}),v(e.message),w(!1),setTimeout(()=>v(null),3e3)):m(e.message)}catch(e){m(e.message)}finally{f(!1)}}},disabled:g||0===Object.keys(c).length,children:t.__("Reset","siteforge")}),a.jsx(o.Button,{variant:"primary",onClick:async()=>{f(!0),m(null),v(null);try{const e=await r({path:"/siteforge/v1/design-system/colors",method:"POST",data:{colors:c}});e.success?(v(e.message),w(!1),setTimeout(()=>v(null),3e3)):m(e.message||t.__("Erreur lors de la sauvegarde.","siteforge"))}catch(e){m(e.message||t.__("Erreur de connexion.","siteforge"))}finally{f(!1)}},disabled:g||!j,isBusy:g,children:g?t.__("Sauvegarde...","siteforge"):t.__("Sauvegarder","siteforge")})]})]}),p&&a.jsx(o.Notice,{status:"error",onRemove:()=>m(null),className:"siteforge-notice",children:p}),x&&a.jsx(o.Notice,{status:"success",onRemove:()=>v(null),className:"siteforge-notice",children:x}),a.jsx("div",{className:"siteforge-admin-content",children:d?a.jsxs("div",{className:"siteforge-loading-container",children:[a.jsx(o.Spinner,{}),a.jsx("p",{children:t.__("Chargement...","siteforge")})]}):"colors"===n?a.jsx(S,{colors:c,onChange:k}):null})]})]})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("siteforge-design-system-app");if(e){s.createRoot(e).render(a.jsx(B,{}))}})}(React,wp.element,wp.i18n,wp.apiFetch,wp.components);
//# sourceMappingURL=design-system.js.map
